# ============================================================================ #
# +++++++++++++++++++++++++++ KITTY CONFIGURATION ++++++++++++++++++++++++++++ #
# ============================================================================ #
#
# Modern terminal emulator configuration optimized for performance and UX.
# Based on official documentation: https://sw.kovidgoyal.net/kitty/conf/
#
# ============================================================================ #

# ================================ Typography ================================ #

# Configure font settings for optimal readability
font_family      CaskaydiaCove Nerd Font Mono
bold_font        auto
italic_font      auto
bold_italic_font auto
font_size        14.5

# =============================== Performance ================================ #

# Optimize performance settings for smooth operation
repaint_delay 8
input_delay 1
sync_to_monitor yes

# ============================== Window Behavior ============================= #

# Customize the appearance and behavior of the terminal window
hide_window_decorations titlebar-only
macos_titlebar_style system
window_padding_width 16
remember_window_size yes
initial_window_width 140c
initial_window_height 40c

# Transparency and background
background_opacity 0.95
background_blur 80
dynamic_background_opacity yes

# Window layout
enabled_layouts tall:bias=50;full_size=1;mirrored=false, fat:bias=50;full_size=1;mirrored=false, grid, horizontal, vertical, stack
window_border_width 1pt
draw_minimal_borders yes
window_margin_width 0
single_window_margin_width -1
active_border_color #3d59a1
inactive_border_color #2c3352

# ============================== Cursor Settings ============================= #

# Customize the appearance and behavior of the terminal cursor
cursor_trail 1
cursor_trail_decay 0.1 0.4

# ================================ macOS Settings ============================ #

# Customize macOS-specific settings
macos_quit_when_last_window_closed no
macos_colorspace default
macos_show_window_title_in window

# ============================= Feature Toggles ============================== #

# Enable or disable specific features
allow_hyperlinks yes
confirm_os_window_close -2
enable_audio_bell no
visual_bell_duration 0.0
window_alert_on_bell yes

# URL handling
url_style curly
open_url_with default
detect_urls yes
show_hyperlink_targets yes

# ============================== Remote Control ============================== #

# Enable remote control features
allow_remote_control yes
listen_on unix:/tmp/kitty

# =========================== Terminal Capabilities ========================== #

# Configure terminal capabilities and behaviors
enable_csi_u_key_encoding yes
enable_reflow_on_resize no
enable_image_scaling yes

# ============================== Resize Behavior ============================= #

# Customize the behavior of the terminal when resizing
resize_draw_strategy blank
resize_debounce_time 0.1 0.5

# ================================= Tab Bar ================================== #

# Customize the appearance and behavior of the tab bar
tab_bar_edge bottom
tab_bar_style custom
tab_bar_min_tabs 1
tab_bar_margin_width 0.0
tab_bar_margin_height 6.0 6.0

# Tab separator and alignment
tab_separator ""
tab_bar_align left

# Tab styling
active_tab_font_style bold
inactive_tab_font_style normal

# Powerline style for tabs
tab_powerline_style slanted

# Disable built-in activity indicators
tab_activity_symbol none
bell_on_tab no

# Session filtering - show only tabs from current session
tab_bar_filter session:~ or session:^$

# Session styling
tab_title_template "{title}"
active_tab_title_template "{title}"
tab_title_max_length 25

# Tab fade for inactive tabs
tab_fade 0.4 0.6 0.8 1.0

# =========================== Terminal Identification ======================== #

# Set the terminal identification string
term xterm-kitty

# ============================= Cursor Behavior ============================== #

# Customize the appearance and behavior of the terminal cursor
shell_integration no-cursor
cursor_shape block
cursor_blink_interval 0.5
cursor_stop_blinking_after 15.0

# ============================ Scrollback Buffer ============================= #

# Configure the scrollback buffer settings
scrollback_lines 10000
scrollback_pager less +G -R
scrollback_pager_history_size 10
scrollback_fill_enlarged_window yes

# ============================ macOS Preferences ============================= #

# Customize macOS-specific preferences
macos_titlebar_color background
macos_option_as_alt no

# ============================== Color Scheme ================================ #

# Define the color scheme for the terminal
cursor #c0caf5
cursor_text_color #1a1b26
selection_foreground none
selection_background #28344a
url_color #9ece6a
bell_border_color #e0af68
macos_titlebar_color #565f89

# Mark colors for hints
mark1_foreground #1a1b26
mark1_background #f7768e
mark2_foreground #1a1b26
mark2_background #7aa2f7
mark3_foreground #1a1b26
mark3_background #73daca

# ============================= Available Themes ============================= #

# -------------------------------- Gruvbox ----------------------------------- #

# background #282828
# foreground #fbf1c7

# Tabs
# active_tab_font_style bold
# active_tab_background #282828
# active_tab_foreground #fbf1c7
# inactive_tab_font_style normal
# inactive_tab_background #282828
# inactive_tab_foreground #fbf1c7

# The 16 terminal colors. There are 8 basic colors, each color has a dull and
# bright version.

# black
# color0   #504945
# color8   #665c54
#
# # red
# color1   #ea6962
# color9   #ef8b7b
#
# # green
# color2   #a9b665
# color10  #c3d69b
#
# # yellow
# color3   #d8a657
# color11  #e5c07b
#
# # blue
# color4   #7daea3
# color12  #89c9b8
#
# # purple
# color5   #d3869b
# color13  #e1acbb
#
# # aqua
# color6   #89b482
# color14  #a1cfa8
#
# # white (FG3/FG4)
# color7   #a89984
# color15  #d4be98

# ------------------------------- Tokyo Night -------------------------------- #
# Based on the "Storm" variant
foreground #a9b1d6
background #1a1b26

# Tab colors
active_tab_font_style   bold
active_tab_foreground   #1a1b26
active_tab_background   #7aa2f7
inactive_tab_font_style normal
inactive_tab_foreground #787c99
inactive_tab_background #1a1b26

# Tab bar background
tab_bar_background #24283b
tab_bar_margin_color #24283b

color0  #414868
color1  #f7768e
color2  #73daca
color3  #e0af68
color4  #7aa2f7
color5  #bb9af7
color6  #7dcfff
color7  #c0caf5
color8  #414868
color9  #f7768e
color10 #73daca
color11 #e0af68
color12 #7aa2f7
color13 #bb9af7
color14 #7dcfff
color15 #c0caf5

# Extended colors for custom tab bar
color16 #ff9e64
color17 #db4b4b
color18 #1f2335
color19 #565f89

# ============================= Nerd Fonts Support =========================== #

# Enable Nerd Fonts for enhanced symbol support
symbol_map U+e000-U+e00a,U+ea60-U+ebeb,U+e0a0-U+e0c8,U+e0ca,U+e0cc-U+e0d4,U+e200-U+e2a9,U+e300-U+e3e3,U+e5fa-U+e6b1,U+e700-U+e7c5,U+f000-U+f2e0,U+f300-U+f372,U+f400-U+f532,U+f0001-U+f1af0 Symbols Nerd Font Mono
symbol_map U+F0001-U+F1af0 CaskaydiaCove Nerd Font

# ================================ Keybindings =============================== #

# Tabs and windows
map cmd+t launch --type=tab --cwd=current
map cmd+n launch --type=os-window --cwd=current

# Text navigation
map alt+left  send_text all \x1b[1;3D
map alt+right send_text all \x1b[1;3C
map cmd+left  send_text all \x1bOH
map cmd+right send_text all \x1bOF

# Clipboard operations
map super+v      paste_from_clipboard
map ctrl+shift+s paste_from_selection
map super+c      copy_to_clipboard
map shift+insert paste_from_selection

# Scrolling
map ctrl+shift+up        scroll_line_up
map ctrl+shift+down      scroll_line_down
map ctrl+shift+k         scroll_line_up
map ctrl+shift+j         scroll_line_down
map ctrl+shift+page_up   scroll_page_up
map ctrl+shift+page_down scroll_page_down
map ctrl+shift+home      scroll_home
map ctrl+shift+end       scroll_end
map ctrl+shift+h         show_scrollback

# Window management
map super+n          new_os_window
map super+w          close_window
map ctrl+shift+enter new_window
map ctrl+shift+]     next_window
map ctrl+shift+[     previous_window
map ctrl+shift+f     move_window_forward
map ctrl+shift+b     move_window_backward
map ctrl+shift+`     move_window_to_top
map ctrl+shift+1     first_window
map ctrl+shift+2     second_window
map ctrl+shift+3     third_window
map ctrl+shift+4     fourth_window
map ctrl+shift+5     fifth_window
map ctrl+shift+6     sixth_window
map ctrl+shift+7     seventh_window
map ctrl+shift+8     eighth_window
map ctrl+shift+9     ninth_window
map ctrl+shift+0     tenth_window

# Tmux-style Tab navigation (Shift+A prefix)
map shift+a>1 goto_tab 1
map shift+a>2 goto_tab 2
map shift+a>3 goto_tab 3
map shift+a>4 goto_tab 4
map shift+a>5 goto_tab 5
map shift+a>6 goto_tab 6
map shift+a>7 goto_tab 7
map shift+a>8 goto_tab 8
map shift+a>9 goto_tab 9
map shift+a>0 goto_tab 10

map shift+a>, set_tab_title

# Tab management
map ctrl+shift+right next_tab
map ctrl+shift+left  previous_tab
map ctrl+shift+t     new_tab
map ctrl+shift+q     close_tab
map ctrl+shift+l     next_layout
map ctrl+shift+.     move_tab_forward
map ctrl+shift+,     move_tab_backward

# Font size
map ctrl+shift+equal     increase_font_size
map ctrl+shift+plus      increase_font_size
map ctrl+shift+minus     decrease_font_size
map ctrl+shift+backspace restore_font_size

# Configuration reload
map ctrl+shift+f5 load_config_file
map ctrl+shift+f6 debug_config

# Window splitting and layout
map cmd+d launch --location=vsplit --cwd=current
map cmd+shift+d launch --location=hsplit --cwd=current
map cmd+shift+[ previous_window
map cmd+shift+] next_window
map cmd+shift+r start_resizing_window

# Layout management
map cmd+shift+l next_layout
map cmd+shift+enter toggle_layout stack

# Opacity control
map cmd+shift+a>m set_background_opacity +0.05
map cmd+shift+a>l set_background_opacity -0.05
map cmd+shift+a>1 set_background_opacity 1
map cmd+shift+a>d set_background_opacity default

# Hints (URLs, paths, hashes)
map cmd+shift+e kitten hints
map cmd+shift+p>f kitten hints --type path --program -
map cmd+shift+p>l kitten hints --type line --program -
map cmd+shift+p>w kitten hints --type word --program -
map cmd+shift+p>h kitten hints --type hash --program -

# Unicode input
map cmd+shift+u kitten unicode_input

# File transfer via SSH
map cmd+shift+f>s kitten transfer

# Scrollback search
map cmd+shift+/ launch --type=overlay --stdin-source=@screen_scrollback fzf --no-sort --no-mouse --exact -i

# ========================== Advanced Kitten Config ========================== #

# Customize hints appearance
action_alias hints_open kitten hints --hints-offset=0 --alphabet=asdfghjklqwertyuiopzxcvbnm

# Custom actions for different hint types
map cmd+shift+o>u hints_open --type=url
map cmd+shift+o>p hints_open --type=path
map cmd+shift+o>l hints_open --type=line --program @
map cmd+shift+o>w hints_open --type=word --program @

# Panel management
map cmd+shift+z toggle_fullscreen
map cmd+shift+m toggle_maximized

# ============================== Session Management ========================== #

# Session switching with prefix cmd+shift+s
map cmd+shift+s>d goto_session ~/.config/kitty/sessions/dotfiles.kitty-session
map cmd+shift+s>p goto_session ~/.config/kitty/sessions/dev-python.kitty-session
map cmd+shift+s>j goto_session ~/.config/kitty/sessions/dev-java.kitty-session
map cmd+shift+s>r goto_session ~/.config/kitty/sessions/dev-rust.kitty-session
map cmd+shift+s>c goto_session ~/.config/kitty/sessions/dev-cpp.kitty-session
map cmd+shift+s>h goto_session ~/.config/kitty/sessions/ssh-dev.kitty-session
map cmd+shift+s>m goto_session ~/.config/kitty/sessions/monitoring.kitty-session

# Session navigation and management
map cmd+shift+s>l goto_session -1
map cmd+shift+s>x close_session
map cmd+shift+s>s save_as_session --use-foreground-process --relocatable

# ============================================================================ #
